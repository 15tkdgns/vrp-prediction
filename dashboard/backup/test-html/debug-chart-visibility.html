<!DOCTYPE html>
<html>
<head>
    <title>Chart Visibility Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { background: #f0f0f0; padding: 15px; margin: 15px 0; border-radius: 8px; }
        .error { background: #ffebee; border-left: 4px solid #f44336; }
        .success { background: #e8f5e8; border-left: 4px solid #4caf50; }
        .warning { background: #fff3e0; border-left: 4px solid #ff9800; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; font-size: 12px; }
        .test-button { background: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 4px; margin: 5px; cursor: pointer; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>ğŸ” Chart Visibility Debugging</h1>
    
    <div class="debug-section">
        <h2>1. JavaScript íŒŒì¼ ë¡œë”© ìƒíƒœ</h2>
        <div id="js-status">í™•ì¸ ì¤‘...</div>
    </div>

    <div class="debug-section">
        <h2>2. Data Manager ìƒíƒœ</h2>
        <div id="data-status">í™•ì¸ ì¤‘...</div>
        <button class="test-button" onclick="testDataManager()">ë°ì´í„° ë§¤ë‹ˆì € í…ŒìŠ¤íŠ¸</button>
    </div>

    <div class="debug-section">
        <h2>3. Chart Manager ìƒíƒœ</h2>
        <div id="chart-status">í™•ì¸ ì¤‘...</div>
        <button class="test-button" onclick="testChartManager()">ì°¨íŠ¸ ë§¤ë‹ˆì € í…ŒìŠ¤íŠ¸</button>
    </div>

    <div class="debug-section">
        <h2>4. StockGrid Component ìƒíƒœ</h2>
        <div id="component-status">í™•ì¸ ì¤‘...</div>
        <button class="test-button" onclick="testStockGrid()">StockGrid í…ŒìŠ¤íŠ¸</button>
    </div>

    <div class="debug-section">
        <h2>5. ì‹¤ì œ ë°ì´í„° í™•ì¸</h2>
        <div id="real-data-status">í™•ì¸ ì¤‘...</div>
        <button class="test-button" onclick="loadRealData()">ì‹¤ì œ ë°ì´í„° ë¡œë“œ</button>
    </div>

    <div class="debug-section">
        <h2>6. DOM ìš”ì†Œ í™•ì¸</h2>
        <div id="dom-status">í™•ì¸ ì¤‘...</div>
        <button class="test-button" onclick="checkDOM()">DOM í™•ì¸</button>
    </div>

    <div class="debug-section">
        <h2>7. Manual Chart Test</h2>
        <div style="width: 300px; height: 150px; border: 2px solid #333; margin: 10px 0;">
            <canvas id="manual-test-chart"></canvas>
        </div>
        <button class="test-button" onclick="createManualChart()">ìˆ˜ë™ ì°¨íŠ¸ ìƒì„±</button>
    </div>

    <script>
        // 1. JavaScript íŒŒì¼ ë¡œë”© ìƒíƒœ í™•ì¸
        function checkJSFiles() {
            const jsStatus = document.getElementById('js-status');
            const classes = ['DataManager', 'ChartManager', 'StockGrid', 'DashboardApp'];
            const status = [];
            
            classes.forEach(className => {
                if (window[className]) {
                    status.push(`âœ… ${className}: ë¡œë“œë¨`);
                } else {
                    status.push(`âŒ ${className}: ë¡œë“œ ì•ˆë¨`);
                }
            });
            
            jsStatus.innerHTML = status.join('<br>');
            jsStatus.className = status.some(s => s.includes('âŒ')) ? 'error' : 'success';
        }

        // 2. Data Manager í…ŒìŠ¤íŠ¸
        function testDataManager() {
            const dataStatus = document.getElementById('data-status');
            try {
                if (window.DataManager) {
                    const dataManager = new DataManager();
                    dataStatus.innerHTML = 'âœ… DataManager ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ';
                    dataStatus.className = 'success';
                } else {
                    dataStatus.innerHTML = 'âŒ DataManager í´ë˜ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ';
                    dataStatus.className = 'error';
                }
            } catch (error) {
                dataStatus.innerHTML = 'âŒ DataManager ìƒì„± ì‹¤íŒ¨: ' + error.message;
                dataStatus.className = 'error';
            }
        }

        // 3. Chart Manager í…ŒìŠ¤íŠ¸
        function testChartManager() {
            const chartStatus = document.getElementById('chart-status');
            try {
                if (window.ChartManager) {
                    const chartManager = new ChartManager();
                    chartStatus.innerHTML = 'âœ… ChartManager ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ<br>';
                    chartStatus.innerHTML += 'Chart.js ë²„ì „: ' + (Chart.version || 'ì•Œ ìˆ˜ ì—†ìŒ');
                    chartStatus.className = 'success';
                } else {
                    chartStatus.innerHTML = 'âŒ ChartManager í´ë˜ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ';
                    chartStatus.className = 'error';
                }
            } catch (error) {
                chartStatus.innerHTML = 'âŒ ChartManager ìƒì„± ì‹¤íŒ¨: ' + error.message;
                chartStatus.className = 'error';
            }
        }

        // 4. StockGrid í…ŒìŠ¤íŠ¸
        function testStockGrid() {
            const componentStatus = document.getElementById('component-status');
            try {
                if (window.StockGrid) {
                    // Mock elements
                    const mockElement = document.createElement('div');
                    const mockDataManager = { data: { stocks: [] } };
                    const mockChartManager = {};
                    
                    const stockGrid = new StockGrid(mockElement, mockDataManager, mockChartManager);
                    componentStatus.innerHTML = 'âœ… StockGrid ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ';
                    componentStatus.className = 'success';
                } else {
                    componentStatus.innerHTML = 'âŒ StockGrid í´ë˜ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ';
                    componentStatus.className = 'error';
                }
            } catch (error) {
                componentStatus.innerHTML = 'âŒ StockGrid ìƒì„± ì‹¤íŒ¨: ' + error.message;
                componentStatus.className = 'error';
            }
        }

        // 5. ì‹¤ì œ ë°ì´í„° ë¡œë“œ í…ŒìŠ¤íŠ¸
        async function loadRealData() {
            const realDataStatus = document.getElementById('real-data-status');
            try {
                const response = await fetch('/data/raw/realtime_results.json');
                const data = await response.json();
                
                if (data && data.predictions && data.predictions.length > 0) {
                    realDataStatus.innerHTML = `âœ… ì‹¤ì œ ë°ì´í„° ë¡œë“œ ì„±ê³µ<br>`;
                    realDataStatus.innerHTML += `ì£¼ì‹ ìˆ˜: ${data.predictions.length}<br>`;
                    realDataStatus.innerHTML += `ì²« ë²ˆì§¸ ì£¼ì‹: ${data.predictions[0].ticker} - $${data.predictions[0].current_price}`;
                    realDataStatus.className = 'success';
                } else {
                    realDataStatus.innerHTML = 'âš ï¸ ë°ì´í„° êµ¬ì¡°ê°€ ì˜ˆìƒê³¼ ë‹¤ë¦„<br><pre>' + JSON.stringify(data, null, 2).substring(0, 500) + '</pre>';
                    realDataStatus.className = 'warning';
                }
            } catch (error) {
                realDataStatus.innerHTML = 'âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ' + error.message;
                realDataStatus.className = 'error';
            }
        }

        // 6. DOM í™•ì¸
        function checkDOM() {
            const domStatus = document.getElementById('dom-status');
            const stockGridElements = document.querySelectorAll('.stock-grid');
            const stockCards = document.querySelectorAll('.stock-card');
            const stockCharts = document.querySelectorAll('.stock-chart');
            
            let html = '';
            html += `Stock Grid ìš”ì†Œ: ${stockGridElements.length}ê°œ<br>`;
            html += `Stock Card ìš”ì†Œ: ${stockCards.length}ê°œ<br>`;
            html += `Stock Chart ìš”ì†Œ: ${stockCharts.length}ê°œ<br>`;
            
            if (stockGridElements.length === 0) {
                html += 'âŒ .stock-grid ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ<br>';
            }
            
            if (stockCards.length === 0) {
                html += 'âŒ .stock-card ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ<br>';
            }
            
            if (stockCharts.length === 0) {
                html += 'âŒ .stock-chart ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ<br>';
            }
            
            domStatus.innerHTML = html;
            domStatus.className = (stockGridElements.length === 0) ? 'error' : 'success';
        }

        // 7. ìˆ˜ë™ ì°¨íŠ¸ ìƒì„±
        function createManualChart() {
            const ctx = document.getElementById('manual-test-chart').getContext('2d');
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['7ì›”22ì¼', '7ì›”23ì¼', '7ì›”24ì¼', '7ì›”25ì¼', '7ì›”28ì¼'],
                    datasets: [{
                        label: 'Test Data',
                        data: [100, 105, 103, 107, 110],
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0,123,255,0.1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true }
                    }
                }
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ í™•ì¸
        window.addEventListener('load', () => {
            setTimeout(() => {
                checkJSFiles();
                loadRealData();
                checkDOM();
            }, 2000); // 2ì´ˆ ëŒ€ê¸° í›„ í™•ì¸
        });

        // ì£¼ê¸°ì ìœ¼ë¡œ DOM ìƒíƒœ ì²´í¬
        setInterval(checkDOM, 5000);
    </script>
</body>
</html>