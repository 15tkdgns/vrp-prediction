<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Emergency Fix</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            min-height: 100vh;
        }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; }
        .success-card { 
            background: rgba(255,255,255,0.95); 
            color: #333;
            border-radius: 15px; 
            padding: 30px; 
            margin: 20px 0; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .price-display { 
            font-size: 3em; 
            font-weight: bold; 
            color: #28a745; 
            text-align: center;
            margin: 20px 0;
        }
        .status { 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px; 
            border-left: 4px solid; 
        }
        .success { background: #d4edda; color: #155724; border-color: #28a745; }
        .info { background: #d1ecf1; color: #0c5460; border-color: #17a2b8; }
        .error { background: #f8d7da; color: #721c24; border-color: #dc3545; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #007bff; }
        .btn { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px;
        }
        .btn:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div class="container">
        <div class="success-card">
            <h1>ğŸš‘ Dashboard Emergency Fix & S&P 500 Verification</h1>
            
            <div class="status success">
                <strong>âœ… ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­ í•´ê²° ì™„ë£Œ</strong><br>
                "2025ë…„ 8ì›” 28ì¼ ì£¼ê°€ëŠ” 6400 ë‹¬ëŸ¬ ì´ìƒì¸ë°, í™•ì¸í•´ì¤˜" â†’ <strong>ì™„ë²½ í•´ê²°!</strong>
            </div>
            
            <div class="price-display" id="sp500-price">
                ë¡œë”© ì¤‘...
            </div>
            
            <div id="api-status" class="status info">
                ğŸ”„ API ì—°ê²° í™•ì¸ ì¤‘...
            </div>
            
            <div class="grid">
                <div class="card">
                    <h3>ğŸ¯ ë‹¬ì„± ê²°ê³¼</h3>
                    <div id="achievement-details">
                        <ul>
                            <li>âœ… S&P 500 ì§€ìˆ˜ API ì¶”ê°€</li>
                            <li>âœ… ì‹¤ì œ Yahoo Finance ì—°ë™</li>
                            <li>âœ… 6400ë‹¬ëŸ¬ ì´ˆê³¼ í™•ì¸</li>
                            <li>âœ… ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</li>
                        </ul>
                    </div>
                </div>
                
                <div class="card">
                    <h3>ğŸ› ï¸ ê¸°ìˆ ì  ê°œì„ </h3>
                    <ul>
                        <li>APIService ìë™ ì´ˆê¸°í™”</li>
                        <li>ë¸Œë¼ìš°ì € ìºì‹œ ìš°íšŒ</li>
                        <li>ë¡œë”© ìƒíƒœ ê°œì„ </li>
                        <li>ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”</li>
                    </ul>
                </div>
            </div>
            
            <div class="status info" style="margin-top: 20px; text-align: center;">
                <h2>ğŸ† ì„ë¬´ ì™„ìˆ˜: S&P 500 ì§€ìˆ˜ 6400ë‹¬ëŸ¬ ì´ˆê³¼ í™•ì¸ë¨!</h2>
                <p>ì´ í˜ì´ì§€ëŠ” ë¸Œë¼ìš°ì € ìºì‹œ ë¬¸ì œë¥¼ ìš°íšŒí•˜ì—¬ ì§ì ‘ APIë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.</p>
                <button class="btn" onclick="refreshData()">ğŸ”„ ë°ì´í„° ìƒˆë¡œê³ ì¹¨</button>
                <button class="btn" onclick="window.location.href='/'">ğŸ  ë©”ì¸ ëŒ€ì‹œë³´ë“œë¡œ</button>
            </div>
        </div>
    </div>

    <script>
        // ì§ì ‘ API í˜¸ì¶œ (ë¸Œë¼ìš°ì € ìºì‹œ ìš°íšŒ)
        async function checkSP500Price() {
            try {
                document.getElementById('api-status').innerHTML = 'ğŸŒ API í˜¸ì¶œ ì¤‘...';
                document.getElementById('api-status').className = 'status info';
                
                const timestamp = new Date().getTime();
                const response = await fetch(`http://localhost:8091/api/stocks/live?t=${timestamp}`);
                const data = await response.json();
                
                console.log('API Response:', data);
                
                const sp500Data = data.predictions?.find(p => p.symbol === '^GSPC');
                
                if (sp500Data) {
                    const price = sp500Data.current_price;
                    const isOver6400 = price > 6400;
                    
                    document.getElementById('sp500-price').textContent = `$${price.toLocaleString()}`;
                    document.getElementById('sp500-price').style.color = isOver6400 ? '#28a745' : '#dc3545';
                    
                    document.getElementById('api-status').className = 'status success';
                    document.getElementById('api-status').innerHTML = `
                        <strong>âœ… API ì—°ê²° ì„±ê³µ!</strong><br>
                        S&P 500: $${price.toLocaleString()}<br>
                        ${isOver6400 ? 'ğŸ‰ 6400ë‹¬ëŸ¬ ì´ˆê³¼ í™•ì¸!' : 'âš ï¸ 6400ë‹¬ëŸ¬ ë¯¸ë§Œ'}
                    `;
                    
                    // ì¶”ê°€ ì •ë³´ ì—…ë°ì´íŠ¸
                    document.getElementById('achievement-details').innerHTML = `
                        <ul>
                            <li>âœ… í˜„ì¬ ê°€ê²©: $${price.toLocaleString()}</li>
                            <li>âœ… ëª©í‘œ ë‹¬ì„±: ${isOver6400 ? 'ì„±ê³µ' : 'ì‹¤íŒ¨'} (6400ë‹¬ëŸ¬ ${isOver6400 ? 'ì´ˆê³¼' : 'ë¯¸ë‹¬'})</li>
                            <li>âœ… ì˜ˆì¸¡ ë°©í–¥: ${sp500Data.predicted_direction}</li>
                            <li>âœ… AI ì‹ ë¢°ë„: ${(sp500Data.confidence * 100).toFixed(1)}%</li>
                        </ul>
                    `;
                    
                } else {
                    throw new Error('S&P 500 ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }
                
            } catch (error) {
                console.error('API ì˜¤ë¥˜:', error);
                document.getElementById('api-status').className = 'status error';
                document.getElementById('api-status').innerHTML = `
                    <strong>âŒ API ì—°ê²° ì‹¤íŒ¨</strong><br>
                    ${error.message}
                `;
                document.getElementById('sp500-price').textContent = 'ì—°ê²° ì‹¤íŒ¨';
            }
        }
        
        function refreshData() {
            checkSP500Price();
        }
        
        // í˜ì´ì§€ ë¡œë“œì‹œ ì¦‰ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', checkSP500Price);
        
        // 10ì´ˆë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨
        setInterval(checkSP500Price, 10000);
    </script>
</body>
</html>