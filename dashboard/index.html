<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Stock Prediction Dashboard</title>
    <meta
      name="description"
      content="AI ê¸°ë°˜ ì£¼ì‹ ì˜ˆì¸¡ ëŒ€ì‹œë³´ë“œ - S&P 500 ë° ì£¼ìš” ì¢…ëª© ë¶„ì„"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="css/styles.css" />

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Favicon -->
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“Š</text></svg>"
    />
  </head>

  <body>
    <!-- ë¡œë”© ì¸ë””ì¼€ì´í„° -->
    <div id="loading-indicator">ë¡œë”© ì¤‘...</div>

    <!-- ìƒíƒœ ë©”ì‹œì§€ -->
    <div id="status-message"></div>

    <!-- ì‚¬ì´ë“œë°” ì˜¤ë²„ë ˆì´ -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="dashboard-container">
      <!-- í—¤ë” -->
      <header class="dashboard-header">
        <div class="header-content">
          <button id="sidebar-toggle" class="sidebar-toggle">â˜°</button>
          <h1 class="header-title">ğŸ“Š AI Stock Dashboard</h1>
          <div class="header-controls">
            <span id="current-page-title" class="current-page">ëŒ€ì‹œë³´ë“œ</span>
            <button id="refresh-btn" class="btn btn-primary">
              ğŸ”„ ìƒˆë¡œê³ ì¹¨
            </button>
            <div id="last-update" class="text-muted" style="font-size: 0.9rem">
              <!-- ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„ -->
            </div>
          </div>
        </div>
      </header>

      <!-- ì‚¬ì´ë“œë°” -->
      <nav id="sidebar" class="sidebar">
        <div class="sidebar-header">
          <h3>ğŸ“ˆ ë©”ë‰´</h3>
          <button id="sidebar-close" class="sidebar-close">âœ•</button>
        </div>
        <ul class="sidebar-menu">
          <li class="menu-item active" data-page="overview">
            <a href="#overview" class="menu-link">
              <span class="menu-icon">ğŸ“Š</span>
              <span class="menu-text">ëŒ€ì‹œë³´ë“œ ê°œìš”</span>
            </a>
          </li>
          <li class="menu-item" data-page="stocks">
            <a href="#stocks" class="menu-link">
              <span class="menu-icon">ğŸ“ˆ</span>
              <span class="menu-text">ì£¼ì‹ ë¶„ì„</span>
            </a>
          </li>
          <li class="menu-item" data-page="charts">
            <a href="#charts" class="menu-link">
              <span class="menu-icon">ğŸ“‹</span>
              <span class="menu-text">ì°¨íŠ¸ ë¶„ì„</span>
            </a>
          </li>
          <li class="menu-item" data-page="news">
            <a href="#news" class="menu-link">
              <span class="menu-icon">ğŸ“°</span>
              <span class="menu-text">ë‰´ìŠ¤ & ê°ì •</span>
            </a>
          </li>
          <li class="menu-item" data-page="performance">
            <a href="#performance" class="menu-link">
              <span class="menu-icon">ğŸ¯</span>
              <span class="menu-text">ëª¨ë¸ ì„±ëŠ¥</span>
            </a>
          </li>
          <li class="menu-item" data-page="settings">
            <a href="#settings" class="menu-link">
              <span class="menu-icon">âš™ï¸</span>
              <span class="menu-text">ì„¤ì •</span>
            </a>
          </li>
        </ul>
      </nav>

      <!-- ë©”ì¸ ì½˜í…ì¸  -->
      <main class="main-content" id="main-content">
        <!-- ëŒ€ì‹œë³´ë“œ ê°œìš” í˜ì´ì§€ -->
        <div id="page-overview" class="page-content active">
          <div class="page-header">
            <h2>ğŸ“Š ëŒ€ì‹œë³´ë“œ ê°œìš”</h2>
            <p>AI ì£¼ì‹ ì˜ˆì¸¡ ì‹œìŠ¤í…œì˜ ì „ì²´ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>
          </div>
          <div class="dashboard-grid">
            <section class="stock-grid" style="grid-column: 1 / -1">
              <!-- StockGrid ì»´í¬ë„ŒíŠ¸ -->
            </section>
            <section class="metrics-panel">
              <!-- MetricsPanel ì»´í¬ë„ŒíŠ¸ -->
            </section>
            <section class="news-panel">
              <!-- NewsPanel ì»´í¬ë„ŒíŠ¸ -->
            </section>
          </div>
        </div>

        <!-- ì£¼ì‹ ë¶„ì„ í˜ì´ì§€ -->
        <div id="page-stocks" class="page-content">
          <div class="page-header">
            <h2>ğŸ“ˆ ì£¼ì‹ ë¶„ì„</h2>
            <p>ì‹¤ì‹œê°„ ì£¼ì‹ ë°ì´í„°ì™€ AI ì˜ˆì¸¡ ê²°ê³¼</p>
          </div>
          <div class="dashboard-grid">
            <section class="stock-grid" style="grid-column: 1 / -1">
              <!-- í™•ì¥ëœ StockGrid ì»´í¬ë„ŒíŠ¸ -->
            </section>
            <section class="stock-details" style="grid-column: 1 / -1">
              <!-- ìƒì„¸ ì£¼ì‹ ì •ë³´ -->
            </section>
          </div>
        </div>

        <!-- ì°¨íŠ¸ ë¶„ì„ í˜ì´ì§€ -->
        <div id="page-charts" class="page-content">
          <div class="page-header">
            <h2>ğŸ“‹ ì°¨íŠ¸ ë¶„ì„</h2>
            <p>ë‹¤ì–‘í•œ ì°¨íŠ¸ì™€ ê¸°ìˆ ì  ë¶„ì„ ë„êµ¬</p>
          </div>
          <div class="dashboard-grid">
            <section class="chart-container" style="grid-column: 1 / -1">
              <!-- ChartContainer ì»´í¬ë„ŒíŠ¸ -->
            </section>
            <section class="technical-analysis" style="grid-column: 1 / -1">
              <!-- ê¸°ìˆ ì  ë¶„ì„ ìœ„ì ¯ -->
            </section>
          </div>
        </div>

        <!-- ë‰´ìŠ¤ & ê°ì • ë¶„ì„ í˜ì´ì§€ -->
        <div id="page-news" class="page-content">
          <div class="page-header">
            <h2>ğŸ“° ë‰´ìŠ¤ & ê°ì • ë¶„ì„</h2>
            <p>ì‹œì¥ ë‰´ìŠ¤ì™€ ê°ì • ë¶„ì„ ê²°ê³¼</p>
          </div>
          <div class="dashboard-grid">
            <section class="news-panel enhanced" style="grid-column: 1 / -1">
              <!-- í™•ì¥ëœ NewsPanel ì»´í¬ë„ŒíŠ¸ -->
            </section>
            <section class="sentiment-details" style="grid-column: 1 / -1">
              <!-- ìƒì„¸ ê°ì • ë¶„ì„ -->
            </section>
          </div>
        </div>

        <!-- ëª¨ë¸ ì„±ëŠ¥ í˜ì´ì§€ -->
        <div id="page-performance" class="page-content">
          <div class="page-header">
            <h2>ğŸ¯ ëª¨ë¸ ì„±ëŠ¥</h2>
            <p>AI ëª¨ë¸ì˜ ì„±ëŠ¥ ì§€í‘œì™€ ë¶„ì„</p>
          </div>
          <div class="dashboard-grid">
            <section class="metrics-panel enhanced" style="grid-column: 1 / -1">
              <!-- í™•ì¥ëœ MetricsPanel ì»´í¬ë„ŒíŠ¸ -->
            </section>
            <section class="model-comparison" style="grid-column: 1 / -1">
              <!-- ëª¨ë¸ ë¹„êµ ë¶„ì„ -->
            </section>
          </div>
        </div>

        <!-- ì„¤ì • í˜ì´ì§€ -->
        <div id="page-settings" class="page-content">
          <div class="page-header">
            <h2>âš™ï¸ ì„¤ì •</h2>
            <p>ëŒ€ì‹œë³´ë“œ ì„¤ì • ë° í™˜ê²½ êµ¬ì„±</p>
          </div>
          <div class="settings-grid">
            <section class="api-settings">
              <!-- API ì„¤ì • -->
            </section>
            <section class="refresh-settings">
              <!-- ìƒˆë¡œê³ ì¹¨ ì„¤ì • -->
            </section>
            <section class="display-settings">
              <!-- ë””ìŠ¤í”Œë ˆì´ ì„¤ì • -->
            </section>
          </div>
        </div>
      </main>

      <!-- í‘¸í„° -->
      <footer
        style="
          text-align: center;
          padding: 2rem;
          color: var(--text-secondary);
          font-size: 0.9rem;
        "
      >
        <p>
          &copy; 2025 AI Stock Dashboard. ë°ì´í„°ëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.
        </p>
        <p style="margin-top: 0.5rem">
          <span id="system-status">ì‹œìŠ¤í…œ ìƒíƒœ: ì •ìƒ</span> |
          <span id="data-source">ë°ì´í„° ì†ŒìŠ¤: ë¡œì»¬</span> |
          <span id="chart-count">ì°¨íŠ¸: 0ê°œ</span>
        </p>
      </footer>
    </div>

    <!-- JavaScript -->
    <script src="js/data-manager.js"></script>
    <script src="js/chart-manager.js"></script>
    <script src="js/components.js"></script>
    <script src="js/app.js"></script>

    <!-- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” -->
    <script>
      // ì „ì—­ ì•± ì¸ìŠ¤í„´ìŠ¤
      let app;

      // DOM ë¡œë“œ ì™„ë£Œì‹œ ì•± ì´ˆê¸°í™”
      document.addEventListener('DOMContentLoaded', async () => {
        try {
          console.log('ğŸš€ AI Stock Dashboard ì‹œì‘...');

          // ì•± ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° ì´ˆê¸°í™”
          app = new DashboardApp();
          window.app = app; // ì „ì—­ ì ‘ê·¼ìš©

          await app.init();

          // ìƒíƒœ ì •ë³´ ì—…ë°ì´íŠ¸
          updateSystemInfo();
        } catch (error) {
          console.error('âŒ ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
          showFallbackError(error);
        }
      });

      // ì‹œìŠ¤í…œ ì •ë³´ ì—…ë°ì´íŠ¸
      function updateSystemInfo() {
        try {
          // ì‹œìŠ¤í…œ ìƒíƒœ
          const statusEl = document.getElementById('system-status');
          if (statusEl) {
            statusEl.textContent =
              app && app.isInitialized
                ? 'ì‹œìŠ¤í…œ ìƒíƒœ: ì •ìƒ'
                : 'ì‹œìŠ¤í…œ ìƒíƒœ: ì´ˆê¸°í™” ì¤‘';
            statusEl.style.color =
              app && app.isInitialized
                ? 'var(--success-color)'
                : 'var(--warning-color)';
          }

          // ì°¨íŠ¸ ìˆ˜
          const chartCountEl = document.getElementById('chart-count');
          if (chartCountEl && app && app.chartManager) {
            const chartCount = app.chartManager.charts.size;
            chartCountEl.textContent = `ì°¨íŠ¸: ${chartCount}ê°œ`;
          }

          // ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸
          const lastUpdateEl = document.getElementById('last-update');
          if (lastUpdateEl && app && app.state.lastUpdate) {
            lastUpdateEl.textContent = `ì—…ë°ì´íŠ¸: ${formatTime(app.state.lastUpdate)}`;
          }
        } catch (error) {
          console.warn('ì‹œìŠ¤í…œ ì •ë³´ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
        }
      }

      // ì‹œê°„ í¬ë§·íŒ…
      function formatTime(date) {
        if (!date) return 'ì•Œ ìˆ˜ ì—†ìŒ';
        return new Intl.DateTimeFormat('ko-KR', {
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit',
        }).format(date);
      }

      // í´ë°± ì—ëŸ¬ í‘œì‹œ
      function showFallbackError(error) {
        document.querySelector('.main-content').innerHTML = `
                <div style="text-align: center; padding: 3rem; color: var(--danger-color);">
                    <div style="font-size: 4rem; margin-bottom: 1rem;">âš ï¸</div>
                    <h2>ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹¤íŒ¨</h2>
                    <p style="margin: 1rem 0; color: var(--text-secondary);">
                        ${error.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'}
                    </p>
                    <button class="btn btn-primary" onclick="location.reload()">
                        í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                    </button>
                    <div style="margin-top: 2rem; font-size: 0.9rem; color: var(--text-muted);">
                        ë¬¸ì œê°€ ì§€ì†ë˜ë©´ ë¸Œë¼ìš°ì € ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.
                    </div>
                </div>
            `;
      }

      // 5ì´ˆë§ˆë‹¤ ì‹œìŠ¤í…œ ì •ë³´ ì—…ë°ì´íŠ¸
      setInterval(updateSystemInfo, 5000);

      // ì „ì—­ ì—ëŸ¬ ì²˜ë¦¬
      window.addEventListener('error', (event) => {
        console.error('ì „ì—­ ì—ëŸ¬ ë°œìƒ:', event.error);
      });

      window.addEventListener('unhandledrejection', (event) => {
        console.error('ì²˜ë¦¬ë˜ì§€ ì•Šì€ Promise ê±°ë¶€:', event.reason);
        event.preventDefault();
      });

      // ë””ë²„ê·¸ìš© ì „ì—­ í•¨ìˆ˜ë“¤
      window.getAppDebugInfo = () => {
        if (!app) return { error: 'App not initialized' };
        return app.getDebugInfo();
      };

      window.forceRefresh = () => {
        if (app) {
          app.refresh();
        } else {
          location.reload();
        }
      };

      console.log('ğŸ“± Dashboard HTML ë¡œë“œ ì™„ë£Œ');
    </script>
  </body>
</html>
