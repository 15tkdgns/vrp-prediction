# 프로젝트 히스토리 및 인사이트

> ai-stock-prediction 프로젝트에서 얻은 인사이트와 개발 히스토리

---

## 1. 프로젝트 히스토리

### 타임라인
| 날짜 | 마일스톤 |
|------|----------|
| 2015-01-01 ~ 2024-12-31 | SPY ETF 데이터 수집 기간 |
| 2025-10 | 변동성(RV) 예측 모델 개발 |
| 2025-11-04 | 데이터 무결성 검증 완료, 3대 금기사항 준수 확인 |
| 2025-12 | VRP 예측 연구로 확장 |
| 2025-12-12 | VRP 모델 최종 결과 도출 |
| 2025-12-20 | VRP 프로젝트 분리 |

### 진화 과정
```
1단계: 수익률 예측 시도
   └─ 결과: R² ≈ 0.00 (실패)
   └─ 교훈: 효율적 시장 가설(EMH) 지지

2단계: 변동성(RV) 예측
   └─ 결과: R² = 0.22~0.26
   └─ 성공: 변동성은 예측 가능

3단계: VRP 예측 연구
   └─ 결과: R² = 0.19, 방향 정확도 73.5%
   └─ 트레이딩: 78% 승률, +3%/거래 초과 수익
```

---

## 2. 핵심 인사이트

### 2.1 시장의 본질
> **"시장의 변동성은 예측 가능하지만, 방향성은 예측 불가능하다"**

- **수익률 예측**: 불가능 (R² ≈ 0)
- **변동성 예측**: 가능 (R² = 0.20~0.26)
- **VRP 예측**: 부분적 가능 (R² = 0.19)
- **결론**: EMH와 일치, 변동성 기반 전략이 현실적

### 2.2 모델 선택
| 모델 유형 | 성능 | 결론 |
|-----------|------|------|
| **선형 (ElasticNet, Ridge)** | ✅ 최고 | 단순하고 안정적 |
| 트리 (XGBoost, LightGBM) | ❌ 음의 R² | 과적합 위험 |
| 신경망 (MLP) | ✅ 우수 (0.44) | 데이터 충분 시 효과적 |

**핵심 교훈**: 금융 시계열에서 단순한 모델이 더 효과적

### 2.3 VIX-Beta 이론 (신규 발견)
VIX와 자산 RV의 상관관계가 예측력을 결정:

| 자산 | VIX-RV 상관 | 예측력 (R²) |
|------|------------|-------------|
| GLD (금) | 0.51 (낮음) | **0.37** |
| SPY (S&P 500) | 0.83 (높음) | 0.02 |

**해석**:
- VIX는 S&P 500 옵션 기반 → SPY에 최적화
- VIX-자산 상관 낮을수록 → 예측 가능한 오차 큼 → 모델 학습 가능

### 2.4 특성 중요도
```
VIX 관련  ████████████████████████████ 1위
변동성     ██████████████████████       2위
VRP 래그   ████████████████             3위
수익률     ██████████                   4위
```

**Top 5 특성**:
1. VIX_lag1 (전일 VIX)
2. VIX_lag5 (5일 전 VIX)
3. RV_22d (22일 실현변동성)
4. VRP_lag5 (5일 전 VRP)
5. VRP_ma5 (VRP 5일 이동평균)

---

## 3. 검증 방법론

### 3대 금기사항
| 금기 | 설명 | 상태 |
|------|------|------|
| 데이터 하드코딩 | 직접 수치 입력 금지 | ✅ yfinance 사용 |
| Random 데이터 | 가짜 데이터 생성 금지 | ✅ 실제 시장 데이터만 |
| 데이터 누출 | 미래 정보 사용 금지 | ✅ 시간적 분리 준수 |

### 시간적 분리 원칙
```
t-N  ...  t-1   t   t+1  ...  t+22
[  특성 ≤ t  ]   [  타겟 ≥ t+1  ]
          │          │
          └──── 완전 분리 ────┘
```

### 검증 방법
- **Purged K-Fold CV**: 금융 시계열 특화 (Lopez de Prado, 2018)
- **22일 Gap**: 학습-테스트 간 최소 22일 간격
- **Bootstrap 신뢰구간**: 95% CI 제공

---

## 4. 경제적 가치

### 변동성 예측 (RV) 활용
| 지표 | 전략 | Buy & Hold | 효과 |
|------|------|-----------|------|
| 연간 수익률 | 14.10% | 22.71% | -8.62% |
| **변동성** | **12.24%** | 13.04% | **-0.8%** ✅ |

**결론**: 알파 창출 아닌 **리스크 관리** 목적

### VRP 예측 활용
| 지표 | 값 |
|------|-----|
| 승률 | 77.7% |
| 거래당 초과 수익 | +3.09% |
| 방향 정확도 | 73.5% |

---

## 5. 실무 적용 방안

### 알고리즘 트레이딩
1. **VIX 옵션 거래**: VRP 예측 → 옵션 매도 타이밍
2. **동적 헤징**: 변동성 예측 → 포지션 조정
3. **포지션 사이징**: 변동성 높을 때 포지션 축소

### 리스크 관리
1. **VaR 보정**: 예측 변동성으로 VaR 동적 조정
2. **스톱로스**: 변동성 급등 예측 시 사전 대응
3. **포트폴리오 최적화**: 변동성 기반 자산 배분

---

## 6. 향후 연구 방향

### 단기 과제
- [ ] 다른 자산 적용 (QQQ, IWM, 업종별 ETF)
- [ ] 고빈도 데이터 활용 (시간봉, 분봉)
- [ ] 거래 비용 반영 실제 수익 분석

### 장기 과제
- [ ] Regime-Switching 모델 적용
- [ ] 옵션 그릭스와 통합
- [ ] 실시간 API 서버 구축
- [ ] 자동 매매 시스템 연동

---

## 7. 참고 문헌

1. **Lopez de Prado, M.** (2018). *Advances in Financial Machine Learning*. Wiley.
2. **Corsi, F.** (2009). A Simple Approximate Long-Memory Model of Realized Volatility. *Journal of Financial Econometrics*.
3. **Bollerslev, T., Tauchen, G., & Zhou, H.** (2009). Expected Stock Returns and Variance Risk Premia. *Review of Financial Studies*.
4. **Bekaert, G., & Hoerova, M.** (2014). The VIX, the Variance Premium and Stock Market Volatility. *Journal of Econometrics*.

---

**작성일**: 2025-12-20
**출처**: ai-stock-prediction 프로젝트
