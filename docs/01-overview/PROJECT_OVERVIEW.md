# 📌 프로젝트 개요

> SPY ETF 변동성 예측 시스템 - 상세 개요

---

## 1. 프로젝트 배경

### 1.1 문제 정의

금융 시장에서 **변동성(Volatility)**은 리스크 관리의 핵심 지표입니다. 그러나 변동성은 직접 관측할 수 없고, 과거 데이터로부터 추정해야 합니다.

```
질문: 미래 변동성을 예측할 수 있는가?
목표: 5일 후 실현 변동성(Realized Volatility) 예측
```

### 1.2 왜 SPY ETF인가?

| 특성 | 설명 |
|------|------|
| **대표성** | S&P 500 지수 추종, 미국 시장 대표 |
| **유동성** | 세계에서 가장 거래량이 많은 ETF |
| **데이터 가용성** | 풍부한 히스토리컬 데이터 |
| **실용성** | VIX 옵션, 헤징 전략에 직접 활용 가능 |

---

## 2. 연구 목표

### 2.1 1차 목표: 예측 정확도
- 변동성의 **30% 이상 설명력** 달성
- HAR(Heterogeneous Autoregressive) 모델 대비 성능 개선

### 2.2 2차 목표: 학술적 엄격성
- **Purged K-Fold CV**: 금융 시계열 특화 검증
- **데이터 무결성**: 3대 금기사항 완전 준수
- **재현 가능성**: 모든 결과 재현 가능

### 2.3 3차 목표: 실용적 가치
- **경제적 백테스트**: 거래비용 포함 검증
- **리스크 관리**: 포트폴리오 변동성 감소 실증

---

## 3. 핵심 개념

### 3.1 실현 변동성 (Realized Volatility)

```python
# 5일 실현 변동성 계산
RV_5d = sqrt(sum(r_i^2 for i in [t+1, t+5]))

# 여기서 r_i는 일간 로그 수익률
r_i = log(P_i / P_{i-1})
```

### 3.2 타겟 설계 원칙

```
┌────────────────────────────────────────────────────────┐
│                    시간적 분리 원칙                     │
├────────────────────────────────────────────────────────┤
│  특성(Features): t 시점 이전 데이터만 사용              │
│  타겟(Target): t+1 ~ t+5 시점 데이터로 계산            │
│                                                        │
│  Timeline:  ───[특성]───│t│───[타겟]───                │
│                         ↑                              │
│                    예측 시점                           │
└────────────────────────────────────────────────────────┘
```

### 3.3 변동성의 특성: Volatility Clustering

금융 변동성은 **군집화(Clustering)** 현상을 보입니다:
- 높은 변동성 뒤에 높은 변동성이 올 가능성 ↑
- 낮은 변동성 뒤에 낮은 변동성이 올 가능성 ↑

이 특성이 변동성 예측을 가능하게 합니다.

---

## 4. 데이터 개요

### 4.1 데이터 소스

| 항목 | 상세 |
|------|------|
| **출처** | yfinance API |
| **티커** | SPY (SPDR S&P 500 ETF) |
| **기간** | 2015-01-01 ~ 2024-12-31 |
| **빈도** | 일간 (Daily) |
| **필드** | Open, High, Low, Close, Adj Close, Volume |

### 4.2 데이터 규모

```
총 관측치: 약 2,500개 거래일
학습 세트: 1,095개 (80%)
테스트 세트: 274개 (20%)
특성 수: 31개
```

### 4.3 특성 목록 (Top 10)

| 순위 | 특성명 | 설명 | 중요도 |
|------|--------|------|--------|
| 1 | volatility_20 | 20일 변동성 | ⭐⭐⭐⭐⭐ |
| 2 | realized_vol_20 | 20일 실현 변동성 | ⭐⭐⭐⭐⭐ |
| 3 | volatility_50 | 50일 변동성 | ⭐⭐⭐⭐ |
| 4 | vol_lag_1 | 1일 전 변동성 | ⭐⭐⭐⭐ |
| 5 | return_lag_1 | 1일 전 수익률 | ⭐⭐⭐ |
| 6 | vol_ratio_5_20 | 단기/중기 변동성 비 | ⭐⭐⭐ |
| 7 | volatility_10 | 10일 변동성 | ⭐⭐⭐ |
| 8 | mean_return_20 | 20일 평균 수익률 | ⭐⭐ |
| 9 | skew_20 | 20일 왜도 | ⭐⭐ |
| 10 | momentum_10 | 10일 모멘텀 | ⭐⭐ |

---

## 5. 3대 금기사항

### 5.1 ❌ 데이터 하드코딩 금지

**문제**: 결과를 조작하기 위해 데이터를 직접 코드에 삽입
**해결**: yfinance API로 실시간 데이터 수집

```python
# ✅ 올바른 방법
import yfinance as yf
spy_data = yf.download("SPY", start="2015-01-01", end="2024-12-31")

# ❌ 잘못된 방법
spy_data = pd.DataFrame({
    'Close': [100, 101, 99, ...]  # 하드코딩
})
```

### 5.2 ❌ Random 데이터 생성 금지

**문제**: 실제 데이터 대신 랜덤 데이터로 모델 학습
**해결**: 모든 파이프라인에서 실제 시장 데이터만 사용

```python
# ✅ 실제 데이터
real_returns = spy_data['Close'].pct_change()

# ❌ 랜덤 데이터
fake_returns = np.random.normal(0, 0.01, 1000)  # 금지!
```

### 5.3 ❌ 데이터 누출(Leakage) 금지

**문제**: 미래 정보가 학습에 포함되어 비현실적 성능
**해결**: Purged K-Fold CV로 시간적 분리 보장

```
성능 기준:
- R² > 95%: 데이터 누출 의심 → 검증 필요
- R² 20-40%: 현실적 범위 → 정상
```

---

## 6. 프로젝트 일정

### 6.1 완료된 마일스톤

| 단계 | 내용 | 상태 |
|------|------|------|
| 1 | 데이터 수집 및 전처리 | ✅ 완료 |
| 2 | 특성 공학 (31개 특성) | ✅ 완료 |
| 3 | 모델 개발 (ElasticNet) | ✅ 완료 |
| 4 | Purged K-Fold CV 검증 | ✅ 완료 |
| 5 | 경제적 백테스트 | ✅ 완료 |
| 6 | XAI 분석 (SHAP) | ✅ 완료 |
| 7 | 대시보드 개발 | ✅ 완료 |

### 6.2 현재 상태

```
프로젝트 상태: ✅ 연구 및 개발 완료
다음 단계: 논문 작성 / 실전 배포 준비
```

---

## 7. 핵심 인사이트

> **"시장의 변동성은 예측 가능하지만, 방향성(수익률)은 예측 불가능하다"**

이 결과는 효율적 시장 가설(EMH)과 일치합니다:
- ✅ 변동성 예측: 가능 (R² ≈ 22%)
- ❌ 수익률 예측: 불가능 (R² ≈ 0%)

### 실무 시사점

1. **리스크 관리**: 변동성 예측으로 포지션 사이징 최적화
2. **VIX 옵션**: 변동성 예측 기반 옵션 매매 전략
3. **동적 헤징**: 예측 변동성에 따른 헤지 비율 조정
4. **알고리즘 트레이딩**: 변동성 조건부 자동 매매

---

## 8. 참고 문헌

1. **Lopez de Prado, M.** (2018). *Advances in Financial Machine Learning*. Wiley.
2. **Corsi, F.** (2009). A Simple Approximate Long-Memory Model of Realized Volatility. *Journal of Financial Econometrics*.
3. **Andersen, T. G., & Bollerslev, T.** (1998). Answering the Skeptics: Yes, Standard Volatility Models Do Provide Accurate Forecasts.

---

**문서 작성일**: 2025-12-04
**버전**: 1.0
