# ìµœì¢… ê²°ë¡ : V0 Ridge ëª¨ë¸ ì„ ì • (ìˆ˜ì •)

**ë‚ ì§œ**: 2025-10-02 (ìˆ˜ì •)
**ìµœì¢… ëª¨ë¸**: Ridge Regression (V0)
**Test RÂ²**: 0.303

---

## âš ï¸ ì¤‘ìš”: ì´ì „ ê²°ë¡  ìˆ˜ì •

### ì˜ëª»ëœ ê²°ë¡  (ì´ì „)
- **ì„ ì • ëª¨ë¸**: V2 Regime-Switching
- **ë³´ê³ ëœ RÂ²**: 0.3276
- **ê·¼ê±°**: 6ê°€ì§€ ë°©ë²• ì¤‘ ìµœê³  ì„±ëŠ¥

### ìˆ˜ì •ëœ ê²°ë¡  (í˜„ì¬)
- **ìµœì¢… ëª¨ë¸**: **V0 Ridge Regression**
- **ì‹¤ì œ Test RÂ²**: **0.3030**
- **ê·¼ê±°**: V2ëŠ” ë¶€ì ì ˆí•œ ê²€ì¦ìœ¼ë¡œ ì¸í•œ ê³¼ëŒ€í‰ê°€

---

## ğŸ” ê²€ì¦ ê³¼ì •

### 1. ì°¨íŠ¸ Test RÂ² = -0.17 ë°œê²¬
```
SPY 5-Day Volatility: Actual vs Predicted (Test RÂ² = -0.1719)
```

â†’ ë³´ê³ ëœ RÂ² 0.328ê³¼ í° ì°¨ì´ ë°œê²¬

### 2. V2 ì›ë³¸ ì½”ë“œ ë¶„ì„

**ë¬¸ì œ ë°œê²¬**:
```python
# V2 ì›ë³¸ (ì˜ëª»ëœ ê²€ì¦)
for regime in [0, 1]:
    df_regime = df[df['regime'] == regime].copy()

    # Regimeë³„ë¡œ ë…ë¦½ì ìœ¼ë¡œ 80/20 split
    split = int(len(X) * 0.8)
    X_train, X_test = X[:split], X[split:]  # ì‹œê°„ ìˆœì„œ ë¬´ì‹œ!
```

**ë¬¸ì œì **:
1. Regimeë³„ ë…ë¦½ split â†’ ì „ì²´ ì‹œê°„ ìˆœì„œ ë¬´ì‹œ
2. ê³ ë³€ë™ regimeì—ì„œ train(t=100) > test(t=50) ê°€ëŠ¥
3. Future information leakage ë°œìƒ

### 3. ì˜¬ë°”ë¥¸ ê²€ì¦ ê²°ê³¼

| ë°©ë²• | RÂ² | ê²€ì¦ ë°©ë²• | ìƒíƒœ |
|------|-----|-----------|------|
| V2 ì›ë³¸ (ë³´ê³ ë¨) | 0.328 | Regimeë³„ 80/20 split | âŒ ë¬´íš¨ |
| V2 ì¬í˜„ | -0.055 | Regimeë³„ 80/20 split | âŒ ì‹¤íŒ¨ |
| **V2 ì˜¬ë°”ë¥¸ ê²€ì¦** | **-0.263** | **TimeSeriesSplit** | âŒ **ì™„ì „ ì‹¤íŒ¨** |
| **V0 Ridge** | **0.303** | **Purged K-Fold CV** | âœ… **ìœ íš¨** |

### 4. Regime-Switching ì‹¤íŒ¨ ì›ì¸

**Regime ë¶ˆê· í˜•**:
- ê³ ë³€ë™: 32 ìƒ˜í”Œ (1.3%)
- ì €ë³€ë™: 2,448 ìƒ˜í”Œ (98.7%)

**ê²°ê³¼**:
- K-meansê°€ ì˜ë¯¸ ì—†ëŠ” êµ¬ë¶„
- ëŒ€ë¶€ë¶„ì´ ì €ë³€ë™ regime
- Regime-Switching íš¨ê³¼ zero

---

## âœ… ìµœì¢… ì„ ì • ëª¨ë¸: V0 Ridge Regression

### ì„±ëŠ¥
- **Test RÂ²**: 0.3030
- **Test MAE**: 0.003323
- **Test RMSE**: 0.005305
- **ê²€ì¦**: Purged K-Fold CV (5-fold)
- **ìƒ˜í”Œ**: 2,460
- **íŠ¹ì„±**: 31ê°œ

### íƒ€ê²Ÿ ì„¤ê³„
```python
# ì˜¬ë°”ë¥¸ íƒ€ê²Ÿ (V0)
target_vol_5d[t] = std(returns[t+1:t+6])
```
- t+1ë¶€í„° ì‹œì‘ (ì™„ì „ ë¯¸ë˜)
- 5ì¼ êµ¬ê°„ ë³€ë™ì„±
- ë°ì´í„° ëˆ„ì¶œ zero

### íŠ¹ì„±
- ë³€ë™ì„± lag (1, 2, 3, 5, 10ì¼)
- ë¡¤ë§ í†µê³„ (5, 10, 20ì¼)
- ëª¨ë©˜í…€ (5, 10, 20ì¼)
- ì´ 31ê°œ íŠ¹ì„±

---

## ğŸ“Š ì „ì²´ ì‹¤í—˜ ê²°ê³¼ (ìˆ˜ì •)

| ë²„ì „ | ì ‘ê·¼ ë°©ë²• | ë³´ê³ ëœ RÂ² | ì‹¤ì œ RÂ² | ê²€ì¦ ë°©ë²• | ìƒíƒœ |
|------|-----------|----------|---------|-----------|------|
| **V0** | **Ridge** | **0.303** | **0.303** | **Purged K-Fold** | âœ… **ì„ ì •** |
| V1 | ë¹„ëŒ€ì¹­ íŠ¹ì„± | 0.189 | 0.189 | TimeSeriesSplit | âŒ ì‹¤íŒ¨ |
| V2 | Regime-Switching | 0.328 | **-0.263** | **ë¶€ì ì ˆ** | âŒ **ë¬´íš¨** |
| V3 | íŒ¨í„´ íŠ¹ì„± | 0.86 | 0.86 | TimeSeriesSplit | âŒ ëˆ„ì¶œ |
| V4 | 20ì¼ íƒ€ê²Ÿ | 0.024 | 0.024 | TimeSeriesSplit | âŒ ì‹¤íŒ¨ |
| V5 | Stacking | 0.315 | 0.315 | TimeSeriesSplit | âš ï¸ V0 ìˆ˜ì¤€ |

---

## ğŸ’¡ í•µì‹¬ êµí›ˆ

### 1. ê²€ì¦ ë°©ë²•ì˜ ì¤‘ìš”ì„±
**ì˜ëª»ëœ ê²€ì¦ â†’ ì˜ëª»ëœ ê²°ë¡ **
- V2: Regimeë³„ 80/20 split â†’ RÂ² 0.328 (ê°€ì§œ)
- ì˜¬ë°”ë¥¸ ê²€ì¦: TimeSeriesSplit â†’ RÂ² -0.26 (ì§„ì§œ)

### 2. ì‹œê°„ ìˆœì„œ ë³´ì¡´ í•„ìˆ˜
- Regimeë³„ ë…ë¦½ splitì€ ì‹œê°„ ìˆœì„œ íŒŒê´´
- ë¯¸ë˜ ì •ë³´ê°€ ê³¼ê±° ì˜ˆì¸¡ì— ì‚¬ìš©ë¨
- TimeSeriesSplit ë˜ëŠ” Purged K-Foldë§Œ ì‚¬ìš©

### 3. ë³µì¡í•œ ë°©ë²•ì˜ í•¨ì •
- Regime-Switching: ì§ê´€ì ì´ì§€ë§Œ ì‹¤íŒ¨
- ë‹¨ìˆœ Ridge: ì§€ë£¨í•˜ì§€ë§Œ íš¨ê³¼ì 
- **Occam's Razor**: ë‹¨ìˆœí•œ ê²ƒì´ ìµœê³ 

### 4. ë°ì´í„° ëˆ„ì¶œì˜ ë‹¤ì–‘í•œ í˜•íƒœ
- **Type 1**: íŠ¹ì„±-íƒ€ê²Ÿ ê²¹ì¹¨ (V3, 55%)
- **Type 2**: ë¶€ì ì ˆí•œ split (V2)
- **Type 3**: ë¯¸ë˜ ì •ë³´ ì‚¬ìš© (shift ì˜¤ë¥˜)

---

## ğŸ“‹ V0 ëª¨ë¸ ìƒì„¸ ìŠ¤í™

### ëª¨ë¸ êµ¬ì¡°
```python
from sklearn.linear_model import Ridge
from sklearn.preprocessing import StandardScaler

model = Ridge(alpha=1.0)
scaler = StandardScaler()
```

### íƒ€ê²Ÿ ìƒì„±
```python
def create_target(returns):
    targets = []
    for i in range(len(returns)):
        if i + 5 < len(returns):
            future_window = returns[i+1:i+6]  # t+1 ~ t+5
            targets.append(future_window.std())
        else:
            targets.append(np.nan)
    return targets
```

### ê²€ì¦ í”„ë¡œí† ì½œ
- **Purged K-Fold CV**: 5-fold
- **Purge length**: 5ì¼
- **Embargo length**: 5ì¼
- **ì‹œê°„ ìˆœì„œ**: ì—„ê²© ë³´ì¡´

---

## ğŸ¯ ì‹¤ë¬´ ì ìš© ê°€ì´ë“œ

### ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ âœ…
1. **5ì¼ ë³€ë™ì„± ì˜ˆì¸¡**: SPY ETF
2. **ë¦¬ìŠ¤í¬ ê´€ë¦¬**: í¬íŠ¸í´ë¦¬ì˜¤ í—¤ì§•
3. **VIX ì˜µì…˜**: ë³€ë™ì„± ë°©í–¥ì„± íŒë‹¨
4. **í¬ì§€ì…˜ ì‚¬ì´ì§•**: ë³€ë™ì„± ê¸°ë°˜ ë ˆë²„ë¦¬ì§€

### ì‚¬ìš© ê¸ˆì§€ ì‹œë‚˜ë¦¬ì˜¤ âŒ
1. ~~ê°€ê²© ì˜ˆì¸¡~~ (ë¶ˆê°€ëŠ¥ ì…ì¦)
2. ~~10ì¼ ì´ìƒ ì¥ê¸° ì˜ˆì¸¡~~ (ì •í™•ë„ ê¸‰ë½)
3. ~~ë‹¤ë¥¸ ìì‚°~~ (ì¬í•™ìŠµ í•„ìš”)
4. ~~Regime êµ¬ë¶„~~ (íš¨ê³¼ ì—†ìŒ)

### ì„±ëŠ¥ í•œê³„
- **RÂ² ìƒí•œ**: ì•½ 0.35 ì¶”ì •
- **í˜„ì¬ ë‹¬ì„±**: 0.303 (86%)
- **ì¶”ê°€ ê°œì„ **: ë¶ˆê°€ëŠ¥ (ë³¸ì§ˆì  í•œê³„)

---

## ğŸ“Š ë²¤ì¹˜ë§ˆí¬ ë¹„êµ

| ëª¨ë¸ | RÂ² | RMSE | MAE | ìƒíƒœ |
|------|-----|------|-----|------|
| **V0 Ridge** | **0.303** | **0.0053** | **0.0033** | âœ… **ìµœì¢…** |
| HAR | 0.0088 | 0.9956 | 0.7984 | í•™ìˆ  ê¸°ì¤€ |
| ê°œì„ í­ | **34.4ë°°** | **188ë°°** | **242ë°°** | ì••ë„ì  |

---

## ğŸ”¬ ì¬í˜„ ê°€ëŠ¥ì„±

### V0 ì¬í˜„ ë°©ë²•
```bash
PYTHONPATH=/root/workspace python3 src/models/correct_target_design.py
```

**ê¸°ëŒ€ ê²°ê³¼**:
- RÂ² â‰ˆ 0.30 Â± 0.05
- Purged K-Fold CV í†µê³¼
- ë°ì´í„° ëˆ„ì¶œ zero

### V2 ì¬í˜„ (ì‹¤íŒ¨ í™•ì¸)
```bash
python3 src/validation/verify_v2_proper.py
```

**ê¸°ëŒ€ ê²°ê³¼**:
- ì›ë³¸ ë°©ì‹: RÂ² â‰ˆ -0.05 (ì‹¤íŒ¨)
- ì˜¬ë°”ë¥¸ ê²€ì¦: RÂ² â‰ˆ -0.26 (ì™„ì „ ì‹¤íŒ¨)

---

## ğŸš« íê¸°ëœ ëª¨ë¸

### V2 Regime-Switching (íê¸°)
- **ì´ìœ **: ë¶€ì ì ˆí•œ ê²€ì¦ ë°©ë²•
- **ë¬¸ì œ**: Regimeë³„ ë…ë¦½ split â†’ ì‹œê°„ ìˆœì„œ íŒŒê´´
- **ì‹¤ì œ ì„±ëŠ¥**: RÂ² = -0.263 (ìŒìˆ˜!)
- **ìƒíƒœ**: **REJECTED**

### V3 Pattern-based (íê¸°)
- **ì´ìœ **: ë°ì´í„° ëˆ„ì¶œ (55% ê²¹ì¹¨)
- **ë¬¸ì œ**: tì¼ High/Low ì‚¬ìš© â†’ ë¯¸ë˜ ì •ë³´ ëˆ„ì¶œ
- **ê°€ì§œ ì„±ëŠ¥**: RÂ² = 0.86
- **ìƒíƒœ**: **REJECTED**

---

## ğŸ“ˆ ê²½ì œì  ê°€ì¹˜ (V0 ê¸°ì¤€)

### ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼
| ì§€í‘œ | ì „ëµ | ë²¤ì¹˜ë§ˆí¬ | íš¨ê³¼ |
|------|------|----------|------|
| ì—° ìˆ˜ìµë¥  | 14.1% | 22.7% | -8.6%p |
| **ë³€ë™ì„±** | **12.2%** | **13.0%** | **-0.8%p** âœ… |
| Sharpe Ratio | 0.99 | 1.59 | -0.60 |
| Max Drawdown | -10.8% | -10.2% | -0.6%p |

**í•µì‹¬ ê°€ì¹˜**: ë¦¬ìŠ¤í¬ ê°ì†Œ (ë³€ë™ì„± 0.8% ê°ì†Œ)

---

## ğŸ“ ê²°ë¡ 

### ìµœì¢… íŒì •
1. âœ… **V0 Ridge Regression ì„ ì •**
2. âŒ **V2 Regime-Switching íê¸°** (ë¶€ì ì ˆí•œ ê²€ì¦)
3. âŒ **V3 Pattern-based íê¸°** (ë°ì´í„° ëˆ„ì¶œ)
4. âš ï¸ **ì¶”ê°€ ê°œì„  ë¶ˆí•„ìš”** (RÂ² 0.30ì´ ì‹¤ì§ˆì  ìƒí•œ)

### í•µì‹¬ ë©”ì‹œì§€
**"ë‹¨ìˆœí•¨ì´ ì´ê¸´ë‹¤"**
- ë³µì¡í•œ Regime-Switching: ì‹¤íŒ¨ (RÂ² -0.26)
- ì •êµí•œ Pattern features: ëˆ„ì¶œ ë˜ëŠ” ì‹¤íŒ¨
- **ë‹¨ìˆœ Ridge**: ì„±ê³µ (RÂ² 0.30)

### ê²€ì¦ì˜ ì¤‘ìš”ì„±
**"ê²€ì¦ ë°©ë²• > ëª¨ë¸ ë³µì¡ë„"**
- ì˜ëª»ëœ ê²€ì¦: RÂ² 0.328 â†’ -0.263 (600% ì˜¤ì°¨!)
- ì˜¬ë°”ë¥¸ ê²€ì¦: ì‹ ë¢° ê°€ëŠ¥í•œ ì„±ëŠ¥ í‰ê°€
- **TimeSeriesSplit ë˜ëŠ” Purged K-Fold í•„ìˆ˜**

### ì‹¤ë¬´ ê¶Œì¥ì‚¬í•­
1. **V0 Ridge ëª¨ë¸ ë°°í¬**
2. **ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•**
3. **ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì‹œìŠ¤í…œ í†µí•©**
4. **ì¶”ê°€ ë³µì¡í™” ì¤‘ë‹¨** (ì„±ëŠ¥ ìƒí•œ ë„ë‹¬)

---

**ìµœì¢… ìŠ¹ì¸**: V0 Ridge Regression Model
**ìƒíƒœ**: PRODUCTION READY
**íê¸°**: V2 Regime-Switching (ê²€ì¦ ë¬´íš¨)
**ì‘ì„±ì¼**: 2025-10-02 (ìˆ˜ì •)
